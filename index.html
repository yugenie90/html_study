<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>탐구반 자동 배정 (대치용)</title>

  <!-- ✅ 파일명이 style.css 이므로 여기를 이렇게 -->
  <link rel="stylesheet" href="./style.css" />

  <script src="https://cdn.jsdelivr.net/npm/exceljs/dist/exceljs.min.js"></script>
</head>

<body>
  <div class="app">
    <!-- Top Header -->
    <header class="topbar">
        <div class="topbar-left">
            <div class="logo">
                <img src="./logo.png" alt="탐구반 자동 배정 로고">
            </div>
      
          <div class="title-wrap">
            <h1 class="title">탐구반 자동 배정</h1>
            <p class="subtitle">
              엑셀 업로드로 탐구반 배정 <b>(대치 전용)</b>
            </p>
          </div>
        </div>
      
        <div class="topbar-right">
          <!-- 기존 뱃지들 -->
        </div>
      </header>
      

    <!-- Main 2-col layout -->
    <main class="layout">
      <!-- Main area (75%) -->
      <section class="main">
        <div class="main-grid">
          <!-- Upload & Run -->
          <div class="card">
            <div class="card-head">
              <h2 class="h2">업로드 & 실행</h2>
              <p class="muted">
                업로드 전 <b>강의정보</b>에서 <b>본인관에서 사용하는 수업만 남겨</b>주세요.
              </p>
              
            </div>

            <label class="upload">
              <input id="file" type="file" accept=".xlsx" />
              <div class="upload-inner">
                <div class="upload-icon">⬆️</div>
                <div class="upload-text">
                  <div class="upload-title">엑셀 파일 업로드</div>
                  <div class="upload-sub">클릭해서 선택하거나 드래그&드롭</div>
                </div>
                <div class="upload-ext">.xlsx</div>
              </div>
            </label>

            <div class="btn-row">
              <button id="run" class="btn btn-primary" disabled>배정 실행</button>
              <button id="download" class="btn btn-secondary" disabled>결과 다운로드</button>
            </div>

            <div class="notice">
              <div class="notice-title">⚠️ 안내 드림다!</div>
              <div class="notice-body">
                - 결과 파일에서 <b>미배정사유</b> / <b>불가능탐구목록</b>을 확인
                
                <span class="block">- 경고가 있는 학생은 <b>빨간색 행</b>으로 표시</span>
                <span class="block">- 이건 처음에 감 잡을때만 쓰기로 해요... 쌤덜 개강 화이팅!!</span>
            
                
              </div>
            </div>
          </div>

          <!-- Logs -->
          <div class="card">
            <div class="card-head">
              <h2 class="h2">실행 로그</h2>
              <p class="muted">오류가 나면 로그를 복사해서 공유하면 빠르게 해결돼요.</p>
            </div>

            <pre id="log" class="log" aria-live="polite"></pre>

            <div class="legend">
              <span class="dot dot-ok"></span>성공
              <span class="dot dot-warn"></span>경고
              <span class="dot dot-err"></span>오류
            </div>
          </div>
        </div>
      </section>

      <!-- Right guide (25%) -->
      <aside class="side">
        <div class="side-head">
          <h2 class="h2">사용 설명서</h2>
          <p class="muted">업로드 전/후에 꼭 확인하세요. (yugenie@hiconsy.com)</p>
          <div class="banner">
            <b>양식 받아가세요!</b>
            <a href="./sample.xlsx" download>샘플 엑셀 받기</a>
          </div>
        </div>

        <div class="side-body">
          <div class="section">
            <div class="section-title">1) 시트 이름</div>
            <div class="chips">
              <span class="chip">강의정보</span>
              <span class="chip">학생정보</span>
            </div>
            <p class="muted small">띄어쓰기/철자 다르면 실패합니다.</p>
          </div>

          <div class="section">
            <div class="section-title">2) 강의정보 필수 컬럼</div>
            <div class="chips">
              <span class="chip">과목</span><span class="chip">유형</span><span class="chip">반</span>
              <span class="chip">강의실</span><span class="chip">요일</span><span class="chip">교시</span><span class="chip">최대인원</span>
            </div>
            
            <p class="muted small">※ 강의정보 받아서 인원은 직접 입력</p>
          </div>

          <div class="section">
            <div class="section-title">3) 학생정보 필수 컬럼</div>
            <div class="chips">
              <span class="chip">일련번호</span><span class="chip">반</span><span class="chip">탐구1</span><span class="chip">탐구2</span>
            </div>
          </div>

          <div class="section">
            <div class="section-title">4) 배정 규칙 요약</div>
            <ul class="list">
              <li>필수수업과 <b>요일+교시가 겹치면</b> 해당 탐구는 불가능</li>
              <li><b>정원 90%</b>가 차면 → <b>다른반에 분산</b> → 그래도 안되면 마지막에 <b>100%</b> 허용</li>
              <li>같은 반은 가능하면 같은 탐구(절대값 아님)</li>
              <li>결과에서 <b>미배정사유</b> / <b>불가능탐구목록</b> 확인</li>
            </ul>
          </div>

          <div class="section">
            <div class="section-title">5) 결과 파일 시트</div>
            <ul class="list">
              <li><b>학생별배정</b>: 학생 기준 결과(사유 포함)</li>
              <li><b>불가능탐구_요약</b>: 반 기준 불가능 탐구 목록</li>
            </ul>
          </div>
        </div>
      </aside>
    </main>
  </div>

  <script src="./app.js"></script>
</body>
</html>
