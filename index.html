<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>탐구반 자동 배정 (대치 전용)</title>

  <link rel="stylesheet" href="./styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/exceljs/dist/exceljs.min.js"></script>
</head>

<body>
  <div class="page">
    <header class="header">
      <div class="header-inner">
        <div class="brand">
          <div class="brand-mark">A</div>
          <div>
            <h1 class="h1">탐구반 자동 배정</h1>
            <p class="sub">엑셀 1개 업로드로 탐구반 배정을 빠르고 안전하게.</p>
          </div>
        </div>

        <div class="pill-row">
          <span class="pill pill-solid">대치 전용</span>
          <span class="pill">필수 충돌 금지</span>
          <span class="pill">탐구 조합 우선</span>
          <span class="pill pill-warn">정원 초과 시 분할</span>
        </div>
      </div>
    </header>

    <main class="container">
      <section class="grid">
        <!-- 좌측: 업로드/실행 -->
        <div class="card">
          <div class="card-head">
            <h2 class="h2">업로드 & 실행</h2>
            <p class="muted">
              업로드 전 <b>강의정보</b>에서 <b>목동/기숙 강의실 행은 삭제</b>해주세요.
            </p>
          </div>

          <label class="upload">
            <input id="file" type="file" accept=".xlsx" />
            <div class="upload-inner">
              <div class="upload-icon">⬆️</div>
              <div class="upload-text">
                <div class="upload-title">엑셀 파일 업로드</div>
                <div class="upload-sub">클릭해서 선택하거나 드래그&드롭</div>
              </div>
              <div class="upload-ext">.xlsx</div>
            </div>
          </label>

          <div class="btn-row">
            <button id="run" class="btn btn-primary" disabled>배정 실행</button>
            <button id="download" class="btn btn-secondary" disabled>결과 다운로드</button>
          </div>

          <div class="notice">
            <div class="notice-title">⚠️ 경고 표시</div>
            <div class="notice-body">
              결과 파일에서 <b>⚠️</b>가 있는 학생은 <b>빨간색 행</b>으로 표시됩니다.
            </div>
          </div>
        </div>

        <!-- 우측: 로그 -->
        <div class="card">
          <div class="card-head">
            <h2 class="h2">실행 로그</h2>
            <p class="muted">문제가 생기면 여기 메시지를 확인하세요.</p>
          </div>

          <pre id="log" class="log" aria-live="polite"></pre>

          <div class="legend">
            <span class="dot dot-ok"></span>성공
            <span class="dot dot-warn"></span>경고
            <span class="dot dot-err"></span>오류
          </div>
        </div>

        <!-- 하단: 가이드 -->
        <div class="card card-wide" id="guide">
          <div class="card-head">
            <h2 class="h2">업로드 가이드</h2>
            <p class="muted">시트 이름/컬럼명이 정확해야 합니다.</p>
          </div>

          <div class="guide-grid">
            <div class="guide">
              <div class="guide-title">시트 이름</div>
              <div class="chips">
                <span class="chip">강의정보</span>
                <span class="chip">학생정보</span>
              </div>
              <p class="muted small">예: “강의 정보”, “학생 정보”는 실패합니다.</p>
            </div>

            <div class="guide">
              <div class="guide-title">강의정보 필수 컬럼</div>
              <div class="chips">
                <span class="chip">과목</span><span class="chip">유형</span><span class="chip">반</span>
                <span class="chip">강의실</span><span class="chip">요일</span><span class="chip">교시</span><span class="chip">최대인원</span>
              </div>
              <div class="banner">
                <b>목동/기숙 강의실 행 삭제</b>
                <span>강의실이 목동관/목동W관/기숙관으로 시작하는 행은 제거</span>
              </div>
            </div>

            <div class="guide">
              <div class="guide-title">학생정보 필수 컬럼</div>
              <div class="chips">
                <span class="chip">일련번호</span><span class="chip">관</span><span class="chip">반</span>
                <span class="chip">탐구1</span><span class="chip">탐구2</span>
              </div>
              <p class="muted small">
                대치 관만 처리: <b>W관, N관, S관, 브릿지관, M3관, 3H관, 신관</b>
              </p>
            </div>
          </div>

          <details class="details">
            <summary>자동 배정 규칙 자세히 보기</summary>
            <div class="details-body">
              <ul>
                <li>필수 수업은 반 기준 고정이며, <b>요일+교시가 겹치면</b> 탐구 배정이 불가합니다.</li>
                <li>같은 <b>(반+관+탐구1+탐구2)</b> 조합 학생은 가능한 한 같은 탐구반 조합으로 배정합니다.</li>
                <li>정원 부족 시 가능한 만큼 유지하고, 남는 학생은 분할 배정되며 경고가 표시됩니다.</li>
              </ul>
            </div>
          </details>
        </div>
      </section>

      <footer class="footer">
        <span class="muted">대치 전용 · 내부 운영 자동화</span>
      </footer>
    </main>
  </div>

  <script src="./app.js"></script>
</body>
</html>
